var ue=Object.defineProperty;var me=(e,t)=>{for(var r in t)ue(e,r,{get:t[r],enumerable:!0})};import*as D from"node:module";import{pathToFileURL as Ve}from"node:url";var B={};me(B,{DEBUG:()=>de});var de=pe(process.env.DEBUG);function pe(e){if(e===void 0)return!1;if(e==="true"||e==="1")return!0;if(e==="false"||e==="0")return!1;if(e==="*")return!0;let t=e.split(",").map(r=>r.split(":")[0]);return t.includes("-tailwindcss")?!1:!!t.includes("tailwindcss")}import y from"enhanced-resolve";import{createJiti as ze}from"jiti";import M from"node:fs";import ae from"node:fs/promises";import F,{dirname as ne}from"node:path";import{pathToFileURL as se}from"node:url";import{__unstable__loadDesignSystem as Ge,compile as Je}from"tailwindcss";import P from"node:fs/promises";import A from"node:path";var ge=[/import[\s\S]*?['"](.{3,}?)['"]/gi,/import[\s\S]*from[\s\S]*?['"](.{3,}?)['"]/gi,/export[\s\S]*from[\s\S]*?['"](.{3,}?)['"]/gi,/require\(['"`](.+)['"`]\)/gi],he=[".js",".cjs",".mjs"],xe=["",".js",".cjs",".mjs",".ts",".cts",".mts",".jsx",".tsx"],ye=["",".ts",".cts",".mts",".tsx",".js",".cjs",".mjs",".jsx"];async function Ae(e,t){for(let r of t){let o=`${e}${r}`;if((await P.stat(o).catch(()=>null))?.isFile())return o}for(let r of t){let o=`${e}/index${r}`;if(await P.access(o).then(()=>!0,()=>!1))return o}return null}async function W(e,t,r,o){let n=he.includes(o)?xe:ye,i=await Ae(A.resolve(r,t),n);if(i===null||e.has(i))return;e.add(i),r=A.dirname(i),o=A.extname(i);let s=await P.readFile(i,"utf-8"),c=[];for(let a of ge)for(let l of s.matchAll(a))l[1].startsWith(".")&&c.push(W(e,l[1],r,o));await Promise.all(c)}async function z(e){let t=new Set;return await W(t,e,A.dirname(e),A.extname(e)),Array.from(t)}import*as I from"node:path";var R=92,v=47,E=42,Re=34,we=39,Ce=58,_=59,h=10,w=32,N=9,G=123,U=125,b=40,J=41,Se=91,ve=93,K=45,T=64,Ee=33;function H(e){e=e.replaceAll(`\r
`,`
`);let t=[],r=[],o=[],n=null,i=null,s="",c="",a;for(let l=0;l<e.length;l++){let u=e.charCodeAt(l);if(u===R)s+=e.slice(l,l+2),l+=1;else if(u===v&&e.charCodeAt(l+1)===E){let f=l;for(let d=l+2;d<e.length;d++)if(a=e.charCodeAt(d),a===R)d+=1;else if(a===E&&e.charCodeAt(d+1)===v){l=d+1;break}let m=e.slice(f,l+1);m.charCodeAt(2)===Ee&&r.push(Q(m.slice(2,-2)))}else if(u===we||u===Re){let f=l;for(let m=l+1;m<e.length;m++)if(a=e.charCodeAt(m),a===R)m+=1;else if(a===u){l=m;break}else{if(a===_&&e.charCodeAt(m+1)===h)throw new Error(`Unterminated string: ${e.slice(f,m+1)+String.fromCharCode(u)}`);if(a===h)throw new Error(`Unterminated string: ${e.slice(f,m)+String.fromCharCode(u)}`)}s+=e.slice(f,l+1)}else{if((u===w||u===h||u===N)&&(a=e.charCodeAt(l+1))&&(a===w||a===h||a===N))continue;if(u===h){if(s.length===0)continue;a=s.charCodeAt(s.length-1),a!==w&&a!==h&&a!==N&&(s+=" ")}else if(u===K&&e.charCodeAt(l+1)===K&&s.length===0){let f="",m=l,d=-1;for(let p=l+2;p<e.length;p++)if(a=e.charCodeAt(p),a===R)p+=1;else if(a===v&&e.charCodeAt(p+1)===E){for(let g=p+2;g<e.length;g++)if(a=e.charCodeAt(g),a===R)g+=1;else if(a===E&&e.charCodeAt(g+1)===v){p=g+1;break}}else if(d===-1&&a===Ce)d=s.length+p-m;else if(a===_&&f.length===0){s+=e.slice(m,p),l=p;break}else if(a===b)f+=")";else if(a===Se)f+="]";else if(a===G)f+="}";else if((a===U||e.length-1===p)&&f.length===0){l=p-1,s+=e.slice(m,p);break}else(a===J||a===ve||a===U)&&f.length>0&&e[p]===f[f.length-1]&&(f=f.slice(0,-1));let x=q(s,d);n?n.nodes.push(x):t.push(x),s=""}else if(u===_&&s.charCodeAt(0)===T)i=C(s),n?n.nodes.push(i):t.push(i),s="",i=null;else if(u===_&&c[c.length-1]!==")"){let f=q(s);n?n.nodes.push(f):t.push(f),s=""}else if(u===G&&c[c.length-1]!==")")c+="}",i=k(s.trim()),n&&n.nodes.push(i),o.push(n),n=i,s="",i=null;else if(u===U&&c[c.length-1]!==")"){if(c==="")throw new Error("Missing opening {");if(c=c.slice(0,-1),s.length>0)if(s.charCodeAt(0)===T)i=C(s),n?n.nodes.push(i):t.push(i),s="",i=null;else{let m=s.indexOf(":");if(n){let d=s.indexOf("!important",m+1);n.nodes.push({kind:"declaration",property:s.slice(0,m).trim(),value:s.slice(m+1,d===-1?s.length:d).trim(),important:d!==-1})}}let f=o.pop()??null;f===null&&n&&t.push(n),n=f,s="",i=null}else if(u===b)c+=")",s+="(";else if(u===J){if(c[c.length-1]!==")")throw new Error("Missing opening (");c=c.slice(0,-1),s+=")"}else{if(s.length===0&&(u===w||u===h||u===N))continue;s+=String.fromCharCode(u)}}}if(s.charCodeAt(0)===T&&t.push(C(s)),c.length>0&&n){if(n.kind==="rule")throw new Error(`Missing closing } at ${n.selector}`);if(n.kind==="at-rule")throw new Error(`Missing closing } at ${n.name} ${n.params}`)}return r.length>0?r.concat(t):t}function C(e,t=[]){for(let r=5;r<e.length;r++){let o=e.charCodeAt(r);if(o===w||o===b){let n=e.slice(0,r).trim(),i=e.slice(r).trim();return S(n,i,t)}}return S(e.trim(),"",t)}function q(e,t=e.indexOf(":")){let r=e.indexOf("!important",t+1);return{kind:"declaration",property:e.slice(0,t).trim(),value:e.slice(t+1,r===-1?e.length:r).trim(),important:r!==-1}}var _e=64;function Ne(e,t=[]){return{kind:"rule",selector:e,nodes:t}}function S(e,t="",r=[]){return{kind:"at-rule",name:e,params:t,nodes:r}}function k(e,t=[]){return e.charCodeAt(0)===_e?C(e,t):Ne(e,t)}function Y(e,t){return{kind:"declaration",property:e,value:t,important:!1}}function Q(e){return{kind:"comment",value:e}}function $(e,t,r=[],o={}){for(let n=0;n<e.length;n++){let i=e[n],s=[...r,i],c=r.at(-1)??null;if(i.kind==="context"){$(i.nodes,t,r,{...o,...i.context});continue}let a=t(i,{parent:c,context:o,path:s,replaceWith(l){e.splice(n,1,...Array.isArray(l)?l:[l]),n--}})??0;if(a===2)return;a!==1&&(i.kind==="rule"||i.kind==="at-rule")&&$(i.nodes,t,s,o)}}function X(e){let t="",r=new Set,o=[],n=[];function i(l,u=0){let f="",m="  ".repeat(u);if(l.kind==="rule"){f+=`${m}${l.selector} {
`;for(let d of l.nodes)f+=i(d,u+1);f+=`${m}}
`}else if(l.kind==="at-rule"){if(l.nodes.length===0)return`${m}${l.name} ${l.params};
`;if(l.name==="@property"&&u===0){if(r.has(l.params))return"";let d=l.params,x=null,p=!1;for(let g of l.nodes)g.kind==="declaration"&&(g.property==="initial-value"?x=g.value:g.property==="inherits"&&(p=g.value==="true"));p?o.push(Y(d,x??"initial")):n.push(Y(d,x??"initial")),r.add(l.params)}f+=`${m}${l.name}${l.params?` ${l.params} `:" "}{
`;for(let d of l.nodes)f+=i(d,u+1);f+=`${m}}
`}else if(l.kind==="comment")f+=`${m}/*${l.value}*/
`;else if(l.kind==="context")for(let d of l.nodes)f+=i(d,u);else if(l.kind==="at-root"){for(let d of l.nodes)t+=i(d,0);return f}else l.property!=="--tw-sort"&&l.value!==void 0&&l.value!==null&&(f+=`${m}${l.property}: ${l.value}${l.important?" !important":""};
`);return f}let s="";for(let l of e){let u=i(l);u!==""&&(s+=u)}let c=[];o.length&&c.push(k(":root",o)),n.length&&c.push(k("*, ::before, ::after, ::backdrop",n));let a="";return c.length&&(a=i(S("@supports","(-moz-orient: inline)",[S("@layer","base",c)]))),`${s}${a}${t}`}function ke(e,t){if(typeof e!="string")throw new TypeError("expected path to be a string");if(e==="\\"||e==="/")return"/";var r=e.length;if(r<=1)return e;var o="";if(r>4&&e[3]==="\\"){var n=e[2];(n==="?"||n===".")&&e.slice(0,2)==="\\\\"&&(e=e.slice(2),o="//")}var i=e.split(/[/\\]+/);return t!==!1&&i[i.length-1]===""&&i.pop(),o+i.join("/")}function j(e){let t=ke(e);return e.startsWith("\\\\")&&t.startsWith("/")&&!t.startsWith("//")?`/${t}`:t}var O=/(?<!@import\s+)(?<=^|[^\w\-\u0080-\uffff])url\((\s*('[^']+'|"[^"]+")\s*|[^'")]+)\)/,V=/(?<=image-set\()((?:[\w-]{1,256}\([^)]*\)|[^)])*)(?=\))/,$e=/(?:gradient|element|cross-fade|image)\(/,De=/^\s*data:/i,Pe=/^([a-z]+:)?\/\//,Ue=/^[A-Z_][.\w-]*\(/i,Te=/(?:^|\s)(?<url>[\w-]+\([^)]*\)|"[^"]*"|'[^']*'|[^,]\S*[^,])\s*(?:\s(?<descriptor>\w[^,]+))?(?:,|$)/g,be=/(?<!\\)"/g,je=/(?: |\\t|\\n|\\f|\\r)+/g,Ie=e=>De.test(e),Oe=e=>Pe.test(e);async function Z({css:e,base:t,root:r}){if(!e.includes("url(")&&!e.includes("image-set("))return e;let o=H(e),n=[];function i(s){let c=I.posix.join(j(t),s),a=I.posix.relative(j(r),c);return a.startsWith(".")||(a="./"+a),a}return $(o,s=>{if(s.kind!=="declaration"||!s.value)return;let c=O.test(s.value),a=V.test(s.value);if(c||a){let l=a?Fe:ee;n.push(l(s.value,i).then(u=>{s.value=u}))}}),n.length&&await Promise.all(n),X(o)}function ee(e,t){return re(e,O,async r=>{let[o,n]=r;return await te(n.trim(),o,t)})}async function Fe(e,t){return await re(e,V,async r=>{let[,o]=r;return await Me(o,async({url:i})=>O.test(i)?await ee(i,t):$e.test(i)?i:await te(i,i,t))})}async function te(e,t,r,o="url"){let n="",i=e[0];if((i==='"'||i==="'")&&(n=i,e=e.slice(1,-1)),Le(e))return t;let s=await r(e);return n===""&&s!==encodeURI(s)&&(n='"'),n==="'"&&s.includes("'")&&(n='"'),n==='"'&&s.includes('"')&&(s=s.replace(be,'\\"')),`${o}(${n}${s}${n})`}function Le(e){return Oe(e)||Ie(e)||e[0]==="#"||Ue.test(e)}function Me(e,t){return Promise.all(Be(e).map(async({url:r,descriptor:o})=>({url:await t({url:r,descriptor:o}),descriptor:o}))).then(We)}function Be(e){let t=e.trim().replace(je," ").replace(/\r?\n/,"").replace(/,\s+/,", ").replaceAll(/\s+/g," ").matchAll(Te);return Array.from(t,({groups:r})=>({url:r?.url?.trim()??"",descriptor:r?.descriptor?.trim()??""})).filter(({url:r})=>!!r)}function We(e){return e.map(({url:t,descriptor:r})=>t+(r?` ${r}`:"")).join(", ")}async function re(e,t,r){let o,n=e,i="";for(;o=t.exec(n);)i+=n.slice(0,o.index),i+=await r(o),n=n.slice(o.index+o[0].length);return i+=n,i}async function Ke(e,{base:t,onDependency:r,shouldRewriteUrls:o}){let n=await Je(e,{base:t,async loadModule(i,s){return ce(i,s,r)},async loadStylesheet(i,s){let c=await fe(i,s,r);return o&&(c.content=await Z({css:c.content,root:s,base:c.base})),c}});if(n.root&&n.root!=="none"){let i=/[*{]/,s=[];for(let a of n.root.pattern.split("/")){if(i.test(a))break;s.push(a)}if(!await ae.stat(F.resolve(t,s.join("/"))).then(a=>a.isDirectory()).catch(()=>!1))throw new Error(`The \`source(${n.root.pattern})\` does not exist`)}return n}async function qe(e,{base:t}){return Ge(e,{base:t,async loadModule(r,o){return ce(r,o,()=>{})},async loadStylesheet(r,o){return fe(r,o,()=>{})}})}async function ce(e,t,r){if(e[0]!=="."){let s=await le(e,t);if(!s)throw new Error(`Could not resolve '${e}' from '${t}'`);let c=await oe(se(s).href);return{base:ne(s),module:c.default??c}}let o=await le(e,t);if(!o)throw new Error(`Could not resolve '${e}' from '${t}'`);let[n,i]=await Promise.all([oe(se(o).href+"?id="+Date.now()),z(o)]);for(let s of i)r(s);return{base:ne(o),module:n.default??n}}async function fe(e,t,r){let o=await Qe(e,t);if(!o)throw new Error(`Could not resolve '${e}' from '${t}'`);if(r(o),typeof globalThis.__tw_readFile=="function"){let i=await globalThis.__tw_readFile(o,"utf-8");if(i)return{base:F.dirname(o),content:i}}let n=await ae.readFile(o,"utf-8");return{base:F.dirname(o),content:n}}var ie=null;async function oe(e){if(typeof globalThis.__tw_load=="function"){let t=await globalThis.__tw_load(e);if(t)return t}try{return await import(e)}catch{return ie??=ze(import.meta.url,{moduleCache:!1,fsCache:!1}),await ie.import(e)}}var He=y.ResolverFactory.createResolver({fileSystem:new y.CachedInputFileSystem(M,4e3),useSyncFileSystemCalls:!0,extensions:[".css"],mainFields:["style"],conditionNames:["style"]});async function Qe(e,t){if(typeof globalThis.__tw_resolve=="function"){let r=globalThis.__tw_resolve(e,t);if(r)return Promise.resolve(r)}return L(He,e,t)}var Ye=y.ResolverFactory.createResolver({fileSystem:new y.CachedInputFileSystem(M,4e3),useSyncFileSystemCalls:!0,extensions:[".js",".json",".node",".ts"],conditionNames:["node","import"]}),Xe=y.ResolverFactory.createResolver({fileSystem:new y.CachedInputFileSystem(M,4e3),useSyncFileSystemCalls:!0,extensions:[".js",".json",".node",".ts"],conditionNames:["node","require"]});function le(e,t){if(typeof globalThis.__tw_resolve=="function"){let r=globalThis.__tw_resolve(e,t);if(r)return Promise.resolve(r)}return L(Ye,e,t).catch(()=>L(Xe,e,t))}function L(e,t,r){return new Promise((o,n)=>e.resolve({},r,t,{},(i,s)=>{if(i)return n(i);o(s)}))}if(!process.versions.bun){let e=D.createRequire(import.meta.url);D.register?.(Ve(e.resolve("@tailwindcss/node/esm-cache-loader")))}export{qe as __unstable__loadDesignSystem,Ke as compile,B as env,j as normalizePath};
